<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math AI â€“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background: #f0f0f0;
        }
        h1 { color: #333; }
        input, button { font-size: 1.2em; padding: 10px; margin: 5px; }
        #result { margin-top: 20px; font-size: 1.4em; color: #006400; }
        #error { margin-top: 20px; font-size: 1.4em; color: #B22222; }
    </style>
</head>
<body>
    <h1>ğŸ§® Math AI â€“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h1>

    <h2>Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ù…Ù† ØµÙˆØ±Ø©</h2>
    <input type="file" accept="image/*" capture="environment" id="imageInput">
    <button onclick="solveImage()">Ø­Ù„</button>

    <div id="result"></div>
    <div id="error"></div>

    <script>
        async function solveImage() {
            const input = document.getElementById('imageInput');
            const file = input.files[0];
            if (!file) return alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹");

            const fd = new FormData();
            fd.append('file', file);

            document.getElementById('result').innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";
            document.getElementById('error').innerText = "";

            try {
                const res = await fetch('/solve-image', { method: 'POST', body: fd });
                const data = await res.json();

                if (data.ok) {
                    let text = `ğŸ“· Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù…ÙƒØªØ´ÙØ©: ${data.extracted}\n`;
                    if (data.result.error) {
                        document.getElementById('error').innerText = data.result.error;
                    } else if (data.result.type === "equation") {
                        text += `âœ… Ø§Ù„Ø­Ù„: ${data.result.solution}`;
                    } else if (data.result.type === "expression") {
                        text += `ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${data.result.value}`;
                    } else if (data.result.type === "boolean") {
                        text += data.result.equal ? "âœ… Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© ØµØ­ÙŠØ­Ø©" : "âŒ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø®Ø§Ø·Ø¦Ø©";
                    }
                    document.getElementById('result').innerText = text;
                } else {
                    document.getElementById('error').innerText = data.message;
                }
            } catch (err) {
                document.getElementById('error').innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©";
                console.error(err);
            }
        }
    </script>
</body>
</html>
